<div class="max-w-8xl mx-auto p-4">

  <!-- Encabezado -->
  <div class="bg-white rounded-xl shadow-md p-6 mb-6">
    <div class="flex flex-col md:flex-row justify-between items-start md:items-center">
      <div>
        <div class="flex items-center">
          <div class="bg-gray-200 border-2 border-dashed rounded-xl w-16 h-16 flex items-center justify-center">
            <fa-icon [icon]="['fas', getIconName('faKaaba')]" style="font-size: 28px;"></fa-icon>

          </div>
          <h1 class="text-3xl font-bold text-gray-800 ml-5 mt-2">{{workService.work().codigo}}</h1>
        </div>
        <p class="text-gray-600 mt-2 ml-10">{{workService.work().descripcion}}</p>
      </div>
      <div class="mt-4 md:mt-0 flex flex-col items-end">

      </div>
    </div>

    <!--div class="grid grid-cols-1 md:grid-cols-4 gap-4 mt-6 ml-10">
      <div class="border-l-4 border-primary pl-4 py-1">
        <p class="text-sm text-gray-500">Fecha Inicio</p>
        <p class="font-semibold">14/08/2022</p>
      </div>
      <div class="border-l-4 border-secondary pl-4 py-1">
        <p class="text-sm text-gray-500">Fecha Fin Estimada</p>
        <p class="font-semibold">14/09/2025</p>
      </div>
      <div class="border-l-4 border-accent pl-4 py-1">
        <p class="text-sm text-gray-500">Valor del Inventario</p>
        <p class="font-semibold">25 5000</p>
        <!--p class="font-semibold">{{obra.presupuesto | currency}}</p>
      </div>

    </div-->
  </div>

  <!-- Sección superior: 2 columnas -->
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
    <!-- Columna 1: Empresas -->
    <div class="bg-white rounded-xl shadow-md p-6">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-xl font-bold text-gray-800">
          Empresas Constructoras
        </h2>
        <button type="button"
          class="text-blue-700 hover:text-white border border-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-3 py-2.5 text-center me-1 mb-1 dark:border-blue-500 dark:text-blue-500 dark:hover:text-white dark:hover:bg-blue-500 dark:focus:ring-blue-800"
          (click)="openModal()">Agregar</button>
      </div>

      <div class="space-y-4">
        @for (emp of workService.work().empresas; track emp.id) {
        <div
          class="flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:border-primary transition-colors">
          <div class="flex items-start">
            <div class="bg-gray-200 border-2 border-dashed rounded-xl w-16 h-16 flex items-center justify-center">
              <fa-icon [icon]="['fas', getIconName('helmet-safety')]" style="font-size: 28px;"></fa-icon>
            </div>
            <div class="ml-4">
              <h3 class="font-semibold text-gray-800">{{emp.codigo}}</h3>
              <p class="text-sm text-gray-600">{{emp.nombre}}</p>
            </div>
          </div>

          <button type="button"
            class="text-red-700 hover:text-white border border-red-700 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm px-3 py-2.5 text-center me-1 mb-1 dark:border-red-500 dark:text-red-500 dark:hover:text-white dark:hover:bg-red-600 dark:focus:ring-red-900"
            (click)="removeEmpresa(emp)">Eliminar</button>
        </div>
        }
        <!-- Sin empresas -->
        @if (workService.work().empresas.length == 0) {
        <div class="text-center py-6 border-2 border-dashed rounded-lg">
          <i class="fas fa-building text-3xl text-gray-400 mb-3"></i>
          <p class="text-gray-500">No hay empresas asignadas a esta obra</p>
          <button class="mt-3 text-primary hover:underline" (click)="openModal()">Agregar primera empresa</button>
        </div>
        }
      </div>
    </div>

    <!-- Columna 2: Objetos -->
    <div class="bg-white rounded-xl shadow-md p-6">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-xl font-bold text-gray-800">
          <i class="fas fa-cubes mr-2 text-accent"></i>Objetos de la Obra
        </h2>
        <button type="button"
          class="text-blue-700 hover:text-white border border-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-3 py-2.5 text-center me-1 mb-1 dark:border-blue-500 dark:text-blue-500 dark:hover:text-white dark:hover:bg-blue-500 dark:focus:ring-blue-800"
          (click)="openModalObject()">Agregar</button>
      </div>

      <div class="space-y-4">
        @for (obj of objectServ.list(); track obj.id) {
        <div
          class="flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:border-primary transition-colors">
          <div class="flex items-start">
            <div class="bg-gray-200 border-2 border-dashed rounded-xl w-16 h-16 flex items-center justify-center">
              <fa-icon [icon]="['fas', getIconName('faCubes')]" style="font-size: 28px;"></fa-icon>
            </div>
            <div class="ml-4">
              <h3 class="font-semibold text-gray-800">{{obj.codigo}}</h3>
              <p class="text-sm text-gray-600">{{obj.descripcion}}</p>
            </div>
          </div>

          <button type="button"
            class="text-red-700 hover:text-white border border-red-700 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm px-3 py-2.5 text-center me-1 mb-1 dark:border-red-500 dark:text-red-500 dark:hover:text-white dark:hover:bg-red-600 dark:focus:ring-red-900"
            (click)="removeObject(obj)">Eliminar</button>
        </div>
        }

        @if (objectServ.list().length == 0) {
        <!-- Sin objetos -->
        <div class="text-center py-6 border-2 border-dashed rounded-lg">
          <i class="fas fa-cubes text-3xl text-gray-400 mb-3"></i>
          <p class="text-gray-500">No hay objetos definidos para esta obra</p>
          <button class="mt-3 text-primary hover:underline" (click)="openModalObject()">Crear primer objeto</button>
        </div>
        }
      </div>
    </div>
  </div>
  <!-- Sección inferior: Recursos -->
  <div class="bg-white rounded-xl shadow-md p-6">
    <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6">
      <h2 class="text-xl font-bold text-gray-800">
        <i class="fas fa-tools mr-2 text-secondary"></i>Recursos Asignados
      </h2>
      <div class="flex flex-wrap gap-2 mt-4 md:mt-0">
        <div class="relative">
          <fa-icon [icon]="['fas', getIconName('faSearch')]" style="font-size: 20px; margin-right: 5px;"></fa-icon>
          <input type="text" placeholder="Buscar recurso..." class="pl-10 pr-4 py-2 border border-blue-400 rounded-lg"
            (input)="updateSearchTerm($event.target.value)">
        </div>
         <button type="button" (click)="printInv()"
                  class="text-emerald-700 hover:text-white border border-emerald-700 hover:bg-emerald-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-3 py-2.5 text-center me-1 mb-1 dark:border-emerald-500 dark:text-emerald-500 dark:hover:text-white dark:hover:bg-emerald-500 dark:focus:ring-emerald-800">Inventario PDF
                  </button>
      </div>
    </div>

    <div class="border border-gray-100 rounded-lg overflow-hidden">
      <button type="button"
        class="text-blue-700 mt-3 mb-3 ml-3 hover:text-white border border-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-3 py-2.5 text-center me-1 dark:border-blue-500 dark:text-blue-500 dark:hover:text-white dark:hover:bg-blue-500 dark:focus:ring-blue-800"
        (click)="openModalResource(null)">Agregar</button>
      <table class="w-full">
        <thead class="bg-gray-50">
          <tr>
            <th class="px-5 py-3.5 text-left text-sm font-bold text-gray-700">Recurso</th>
            <th class="px-5 py-3.5 text-left text-sm font-bold text-gray-700">Descripción</th>
            <th class="px-5 py-3.5 text-left text-sm font-bold text-gray-700">UM</th>
            <th class="px-5 py-3.5 text-left text-sm font-bold text-gray-700">Cantidad</th>
            <th class="px-5 py-3.5 text-left text-sm font-bold text-gray-700">Precio</th>
            <th class="px-5 py-3.5 text-left text-sm font-bold text-gray-700">Disponible</th>
            <th class="px-5 py-3.5 text-center text-sm font-black text-gray-700"></th>

          </tr>
        </thead>
        <tbody class="divide-y divide-gray-100">
          <!-- Fila de ejemplo -->
          @for (item of resourceServ.filteredResources(); track item.id) {
          <tr class="hover:bg-gray-50 transition-colors">
            <td class="px-5 py-4 text-sm text-gray-700 font-medium">{{item.codigo}}</td>
            <td class="px-5 py-4 text-sm text-gray-600">{{item.descripcion}}</td>
            <td class="px-5 py-4 text-sm text-gray-600">{{item.um}}</td>
            <td class="px-5 py-4 text-sm text-gray-600">{{item.cantidad}}</td>
            <td class="px-5 py-4 text-sm text-gray-600">{{item.precio}}</td>
            <td class="px-5 py-4 text-sm text-gray-600">{{item.disponible}}</td>
            <td class="px-5 py-4 text-center">
              <div class="flex flex-wrap justify-center gap-2">

                <button type="button" (click)="openModalResource(item)"
                  class="text-emerald-700 hover:text-white border border-emerald-700 hover:bg-emerald-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-3 py-2.5 text-center me-1 mb-1 dark:border-emerald-500 dark:text-emerald-500 dark:hover:text-white dark:hover:bg-emerald-500 dark:focus:ring-emerald-800">Editar</button>
                <!--button class="text-blue-600 hover:text-blue-800 text-sm font-medium"  ></button-->
                <button type="button" (click)="removeResource(item)"
                  class="text-red-700 hover:text-white border border-red-700 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm px-3 py-2.5 text-center me-1 mb-1 dark:border-red-500 dark:text-red-500 dark:hover:text-white dark:hover:bg-red-600 dark:focus:ring-red-900">Eliminar</button>
                <!--button class="text-red-600 hover:text-red-800 text-sm font-medium" ></button-->
              </div>
            </td>
          </tr>
          }

        </tbody>
      </table>
    </div>
    @if (resourceServ.list().length == 0) {
    <div class="mt-5 text-center py-12 border-2 border-dashed rounded-lg">
      <i class="fas fa-tools text-4xl text-gray-400 mb-3"></i>
      <p class="text-gray-500">No hay recursos asignados a esta obra</p>
      <button class="mt-3 text-primary hover:underline" (click)="openModalResource(null)">
        <i class="fas fa-plus-circle mr-1"></i> Crear primer recurso
      </button>
    </div>
    }
  </div>


  <!-- Sin recursos -->

  <!-- Paginación >
  @if (resourceServ.list().length) {
  <div class="mt-6 flex flex-col md:flex-row items-center justify-between border-t border-gray-200 pt-4">
    <!--div class="text-sm text-gray-700 mb-4 md:mb-0">
          Mostrando <span class="font-medium">1</span> a <span class="font-medium">{{recursosFiltrados.length}}</span> de <span class="font-medium">{{recursos.length}}</span> recursos
        </div>
    <div class="flex space-x-2">
      <button class="px-3 py-1 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50">
        <i class="fas fa-chevron-left"></i>
      </button>
      <button class="px-3 py-1 bg-primary text-white rounded-md hover:bg-blue-700">
        1
      </button>
      <button class="px-3 py-1 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50">
        2
      </button>
      <button class="px-3 py-1 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50">
        3
      </button>
      <button class="px-3 py-1 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50">
        <i class="fas fa-chevron-right"></i>
      </button>
    </div>
    }

  </div-->
</div>